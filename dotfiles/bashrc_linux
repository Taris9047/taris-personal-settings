# My settings
# enable color support of ls and also add handy aliases
if [ -x /usr/bin/dircolors ]; then
    test -r ~/.dircolors && eval "$(dircolors -b ~/.dircolors)" || eval "$(dircolors -b)"
    alias ls='ls --color=auto'
    alias dir='dir --color=auto'
    alias vdir='vdir --color=auto'
#
    alias grep='grep --color=auto'
    alias fgrep='fgrep --color=auto'
    alias egrep='egrep --color=auto'
fi

alias ls='ls -p -F -h --color=auto --show-control-chars'
alias ll='ls -la'
alias l='ls -p -F -h --color=auto --show-control-chars'
alias rm='rm -i'
alias mv='mv -i'
alias cp='cp -i'
alias grep='grep --color'
alias df='df -h'
alias rsync='rsync -azvh --info=progress2'

if [ "$PS1" ]; then
  PS1="[\u@\h:\l \W]\\$ "
fi

# The homebrew path!!
export HOMEBREW=$HOME/.local

# LD_LIBRARY_PATH
# export LD_LIBRARY_PATH=/usr/lib:/usr/lib64:$HOMEBREW/lib:$HOMEBREW/lib64:$HOMEBREW/Python2/lib:$HOMEBREW/Python3/lib:$LD_LIBRARY_PATH

# PKG_CONFIG_PATH
export PKG_CONFIG_PATH=$PKG_CONFIG_PATH:/usr/lib64/pkgconfig:/usr/lib/pkgconfig

# Path extension for Homebrew!!
export PATH=$HOMEBREW/bin:$HOMEBREW/opt/bin:/opt/bin/:$PATH

# Python3
if [ -e "$HOMEBREW/Pythone3/bin/python3" ]; then
    export PY3HOME=$HOMEBREW/Python3
    export PATH=$PY3HOME/bin:$PATH
fi

# Node.JS
export NODEJS_HOME=$HOMEBREW/Node
export PATH=$NODEJS_HOME/bin:$PATH

# QT
# export QT4_HOME=$HOMEBREW/Qt
# export QT5_HOME=$HOMEBREW/Qt5
# export PATH=$PATH:$QT5_HOME/bin

# Atom - Portable install
export ATOM_HOME=$HOMEBREW/opt/Atom
export PATH=$ATOM_HOME:$PATH

# Some envs
RPATH="-Wl,-rpath $HOMEBREW/lib64 -Wl,-rpath $HOMEBREW/lib"

if [ -e "$HOMEBREW/bin/gcc" ]; then
	export CC=$HOMEBREW/bin/gcc
	export CFLAGS="-march=native -fomit-frame-pointer -O3 -pipe"
	export LDFLAGS=$RPATH
fi
if [ -e "$HOMEBREW/bin/g++" ]; then
	export CXX=$HOMEBREW/bin/g++
	export CFLAGS="-march=native -fomit-frame-pointer -O3 -pipe"
	export LDFLAGS=$RPATH
fi

# Python Stuffs
if [ -e "$HOMEBREW/Python3/bin/python3" ]; then
    export PY3HOME="$HOMEBREW/Python3"
    export PY3BIN="$PY3HOME/bin"
    RPATH="$RPATH -Wl,-rpath $PY3HOME/lib"
    export LDFLAGS=$RPATH
fi

if [ -e "$HOMEBREW/Python2/bin/python2" ]; then
    export PY2HOME="$HOMEBREW/Python2"
    export PY2BIN="$PY2HOME/bin"
    RPATH="$RPATH -Wl,-rpath $PY2HOME/lib"
    export LDFLAGS=$RPATH
fi



# QT Stuffs
if [ -e "$HOMEBREW/Qt4/bin/qmake" ]; then
    export QT4HOME=$HOMEBREW/Qt4
    export QT4BIN=$QT4HOME/bin
    export QT4MAKE=$QT4BIN/qmake
    RPATH="$RPATH -Wl,-rpath $QT4HOME/lib64 -Wl,-rpath $QT4HOME/lib"
    export LDFLAGS=$RPATH
fi

if [ -e "$HOMEBREW/Qt5/bin/qmake" ]; then
    export QT5HOME=$HOMEBREW/Qt5
    export QT5BIN=$QT5HOME/bin
    export QT5MAKE=$QT5BIN/qmake
    RPATH="$RPATH -Wl,-rpath $QT5HOME/lib64 -Wl,-rpath $QT5HOME/lib"
    export LDFLAGS=$RPATH
fi

# Go
export GO_HOME=$HOMEBREW/opt/go
export PATH=$GO_HOME/bin:$PATH

# Texlive
export TEXLIVE_HOME=$HOMEBREW/opt/texlive
export PATH=$TEXLIVE_HOME/bin/x86_64-linux:$PATH

# Silvaco Stuffs
export SILVACO_HOME=/opt/Silvaco
export PATH=$PATH:$SILVACO_HOME/bin

# Lastly, rpath
export RPATH

# Path selection stuffs
remove_path() {
    # Referenced:
    # https://stackoverflow.com/questions/756756/multiple-commands-in-an-alias-for-bash
    for path in "$@"; do
        PATH="$(echo "$PATH" |sed -e "s#\(^\|:\)$(echo "$path" |sed -e 's/[^^]/[&]/g' -e 's/\^/\\^/g')\(:\|/\{0,1\}$\)#\1\2#" -e 's#:\+#:#g' -e 's#^:\|:$##g')"
    done
}
# The original system path (DO NOT CHANGE IT AT ANY CIRCUMSTANCES)
export SYS_PATH=$PATH

# The selector functions!!
select_python3() {
    $(remove_path $PY2BIN)
    export PATH=$PY3BIN:$PATH
    echo "Selecting Python3 installed at $PY3HOME"
}
select_python2() {
    $(remove_path $PY3BIN)
    export PATH=$PY2BIN:$PATH
    echo "Selecting Python2 installed at $PY2HOME"
}
select_qt4() {
    $(remove_path $QT5BIN)
    export PATH=$QT4BIN:$PATH
    echo "Selecting Qt4 installed at $QT4HOME"
}
select_qt5() {
    $(remove_path $QT4BIN)
    export PATH=$QT5BIN:$PATH
    echo "Selecting Qt5 installed at $QT5HOME"
}

# Restore path!!
restore_path() {
    export PATH=$SYS_PATH
    echo "PATH has been restored to original(?) state!!"
    echo $PATH
}
